{
    "timestamp": "2025-07-20T23:21:32-07:00",
    "backup_type": "full",
    "has_issues": true,
    "summary": "Could not compare schemas: Failed to analyze migration schema: SQLSTATE[42000]: Syntax error or access violation: 1142 CREATE VIEW command denied to user 'laravel_user'@'172.18.0.3' for table 'crop_batches_list_view' (Connection: mysql, SQL: \n            CREATE VIEW crop_batches_list_view AS\n            SELECT \n                cb.id,\n                cb.recipe_id,\n                cb.created_at,\n                cb.updated_at,\n                \n                -- Recipe info\n                r.name as recipe_name,\n                \n                -- Aggregate crop data\n                COUNT(c.id) as crop_count,\n                GROUP_CONCAT(c.tray_number ORDER BY c.tray_number SEPARATOR ', ') as tray_numbers,\n                \n                -- First crop's data (for display)\n                MIN(c.id) as first_crop_id,\n                MIN(c.planting_at) as planting_at,\n                MIN(c.current_stage_id) as current_stage_id,\n                MIN(c.expected_harvest_at) as expected_harvest_at,\n                MIN(c.watering_suspended_at) as watering_suspended_at,\n                \n                -- Time display fields from first crop\n                (SELECT stage_age_display FROM crops WHERE id = MIN(c.id)) as stage_age_display,\n                (SELECT time_to_next_stage_display FROM crops WHERE id = MIN(c.id)) as time_to_next_stage_display,\n                (SELECT total_age_display FROM crops WHERE id = MIN(c.id)) as total_age_display,\n                \n                -- Stage info\n                cs.name as current_stage_name,\n                cs.code as current_stage_code,\n                cs.color as current_stage_color,\n                \n                -- Additional computed fields to avoid N+1 queries\n                (SELECT stage_age_minutes FROM crops WHERE id = MIN(c.id)) as stage_age_minutes,\n                (SELECT time_to_next_stage_minutes FROM crops WHERE id = MIN(c.id)) as time_to_next_stage_minutes,\n                (SELECT total_age_minutes FROM crops WHERE id = MIN(c.id)) as total_age_minutes\n                \n            FROM crop_batches cb\n            INNER JOIN crops c ON c.crop_batch_id = cb.id\n            LEFT JOIN recipes r ON cb.recipe_id = r.id\n            LEFT JOIN crop_stages cs ON c.current_stage_id = cs.id\n            GROUP BY \n                cb.id, \n                cb.recipe_id, \n                cb.created_at, \n                cb.updated_at, \n                r.name,\n                cs.name,\n                cs.code,\n                cs.color\n        )",
    "details": {
        "has_issues": true,
        "summary": "Could not compare schemas: Failed to analyze migration schema: SQLSTATE[42000]: Syntax error or access violation: 1142 CREATE VIEW command denied to user 'laravel_user'@'172.18.0.3' for table 'crop_batches_list_view' (Connection: mysql, SQL: \n            CREATE VIEW crop_batches_list_view AS\n            SELECT \n                cb.id,\n                cb.recipe_id,\n                cb.created_at,\n                cb.updated_at,\n                \n                -- Recipe info\n                r.name as recipe_name,\n                \n                -- Aggregate crop data\n                COUNT(c.id) as crop_count,\n                GROUP_CONCAT(c.tray_number ORDER BY c.tray_number SEPARATOR ', ') as tray_numbers,\n                \n                -- First crop's data (for display)\n                MIN(c.id) as first_crop_id,\n                MIN(c.planting_at) as planting_at,\n                MIN(c.current_stage_id) as current_stage_id,\n                MIN(c.expected_harvest_at) as expected_harvest_at,\n                MIN(c.watering_suspended_at) as watering_suspended_at,\n                \n                -- Time display fields from first crop\n                (SELECT stage_age_display FROM crops WHERE id = MIN(c.id)) as stage_age_display,\n                (SELECT time_to_next_stage_display FROM crops WHERE id = MIN(c.id)) as time_to_next_stage_display,\n                (SELECT total_age_display FROM crops WHERE id = MIN(c.id)) as total_age_display,\n                \n                -- Stage info\n                cs.name as current_stage_name,\n                cs.code as current_stage_code,\n                cs.color as current_stage_color,\n                \n                -- Additional computed fields to avoid N+1 queries\n                (SELECT stage_age_minutes FROM crops WHERE id = MIN(c.id)) as stage_age_minutes,\n                (SELECT time_to_next_stage_minutes FROM crops WHERE id = MIN(c.id)) as time_to_next_stage_minutes,\n                (SELECT total_age_minutes FROM crops WHERE id = MIN(c.id)) as total_age_minutes\n                \n            FROM crop_batches cb\n            INNER JOIN crops c ON c.crop_batch_id = cb.id\n            LEFT JOIN recipes r ON cb.recipe_id = r.id\n            LEFT JOIN crop_stages cs ON c.current_stage_id = cs.id\n            GROUP BY \n                cb.id, \n                cb.recipe_id, \n                cb.created_at, \n                cb.updated_at, \n                r.name,\n                cs.name,\n                cs.code,\n                cs.color\n        )",
        "error": true,
        "extra_tables": [],
        "missing_tables": [],
        "column_differences": []
    },
    "formatted_report": "\u26a0\ufe0f Could not compare schemas: Failed to analyze migration schema: SQLSTATE[42000]: Syntax error or access violation: 1142 CREATE VIEW command denied to user 'laravel_user'@'172.18.0.3' for table 'crop_batches_list_view' (Connection: mysql, SQL: \n            CREATE VIEW crop_batches_list_view AS\n            SELECT \n                cb.id,\n                cb.recipe_id,\n                cb.created_at,\n                cb.updated_at,\n                \n                -- Recipe info\n                r.name as recipe_name,\n                \n                -- Aggregate crop data\n                COUNT(c.id) as crop_count,\n                GROUP_CONCAT(c.tray_number ORDER BY c.tray_number SEPARATOR ', ') as tray_numbers,\n                \n                -- First crop's data (for display)\n                MIN(c.id) as first_crop_id,\n                MIN(c.planting_at) as planting_at,\n                MIN(c.current_stage_id) as current_stage_id,\n                MIN(c.expected_harvest_at) as expected_harvest_at,\n                MIN(c.watering_suspended_at) as watering_suspended_at,\n                \n                -- Time display fields from first crop\n                (SELECT stage_age_display FROM crops WHERE id = MIN(c.id)) as stage_age_display,\n                (SELECT time_to_next_stage_display FROM crops WHERE id = MIN(c.id)) as time_to_next_stage_display,\n                (SELECT total_age_display FROM crops WHERE id = MIN(c.id)) as total_age_display,\n                \n                -- Stage info\n                cs.name as current_stage_name,\n                cs.code as current_stage_code,\n                cs.color as current_stage_color,\n                \n                -- Additional computed fields to avoid N+1 queries\n                (SELECT stage_age_minutes FROM crops WHERE id = MIN(c.id)) as stage_age_minutes,\n                (SELECT time_to_next_stage_minutes FROM crops WHERE id = MIN(c.id)) as time_to_next_stage_minutes,\n                (SELECT total_age_minutes FROM crops WHERE id = MIN(c.id)) as total_age_minutes\n                \n            FROM crop_batches cb\n            INNER JOIN crops c ON c.crop_batch_id = cb.id\n            LEFT JOIN recipes r ON cb.recipe_id = r.id\n            LEFT JOIN crop_stages cs ON c.current_stage_id = cs.id\n            GROUP BY \n                cb.id, \n                cb.recipe_id, \n                cb.created_at, \n                cb.updated_at, \n                r.name,\n                cs.name,\n                cs.code,\n                cs.color\n        )\n\n\ud83d\udca1 Impact on Backups:\n   \u2705 All backup types will work correctly - schema is in sync\n"
}